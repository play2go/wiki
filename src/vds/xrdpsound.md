---
order: 8
authors:
  - SimonSays2310
---

<!-- Источник: https://c-nergy.be/blog/?p=17734 -->

# Поддержка звука в xRDP

:::warning :exclamation: Внимание
Предполагается, что при изучении этой статьи, вы сначала изучили [эту статью](/vds/xrdp). Если же нет, то эта статья, где вы сейчас находитесь, не для вас.
:::

:::warning :exclamation: Внимание
Данная инструкция проверялась на Ubuntu и Debian, на остальных дистрибутивах может не сработать!
:::

К сожалению, перенаправление звука из RDP сессии к вашему компьютеру не работает "из коробки": в микшере виден лишь "Dummy Output", который не передаёт звук на компьютер. Чтобы включить поддержку его передачи, необходима компиляция и установка специального модуля для PulseAudio.

Делается это следующим образом:

:::danger :fire: Критически важно
Данные действия необходимо выполнять в SSH и **на том аккаунте, где установлен xRDP!** Если вы находитесь в RDP сессии, то могут возникнуть проблемы.
:::

:::warning :exclamation: Внимание
Необходимы права суперпользователя! Если вы их не выдали аккаунту, на котором установлен xRDP, то сделать это можно, войдя в `root` аккаунт и прописав команду `usermod -a -G sudo ИМЯ_АККАУНТА`.
:::

1. Устанавливаем необходимые зависимости командой `sudo apt install build-essential dpkg-dev libpulse-dev git autoconf libtool`;

2. Переходим в корневую директорию пользователя (`cd ~`) и клонируем Git репозиторий модуля командой `git clone https://github.com/neutrinolabs/pulseaudio-module-xrdp.git`;

3. Переходим в папку того репозитория, который вы клонировали (`cd pulseaudio-module-xrdp`), и запускаем скрипт командой `scripts/install_pulseaudio_sources_apt_wrapper.sh`, по необходимости введя пароль от своего аккаунта для выдачи прав суперпользователя.

Данный скрипт загружает исходный код PulseAudio и зависимости для его компиляции, а также компилирует его самого. После работы скрипта, необходимо проверить, нет ли каких-либо ошибок, и также обратить внимание на последнюю строку, где указан путь к папке с скомпилированным PulseAudio (обычно `~/pulseaudio.src`).

4. Далее необходимо вернуться в корень папки `pulseaudio-module-xrdp` (если вы оттуда уходили) и выполнить команду `./bootstrap && ./configure PULSE_DIR=~/pulseaudio.src && make`, тем самым начав процесс компиляции звукового модуля для xRDP.

:::warning :exclamation: Внимание
Обратите внимание на переменную `PULSE_DIR`! После завершения работы скрипта для сборки PulseAudio, появляется месторасположение папки где он был сохранён, если вы редактировали скрипт - то оно будет совершенно другим!
:::

5. Если в процессе сборки не было никаких ошибок - установите собранный модуль командой `sudo make install`, после чего зайдите в RDP и пробуйте открыть видео с YouTube/любой музыкальный файл. Если звук начал воспроизводиться, то вы всё сделали правильно.

Если хотите проверить работоспособность модуля, то сделать это можно командой `ls $(pkg-config --variable=modlibexecdir libpulse) | grep xrdp`.
